// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("PG_DATABASE_URL")
}

model User {
  id         Int      @id
  igUsername String   @unique
  igId       String   @unique
  gems       Int      @default(1)
  active     Boolean  @default(true)
  // followers  Account[] @relation("follower")
  // followed   Account[] @relation("followed")
  follows    Follow[] @relation("follows")
  followings Follow[] @relation("followings")
  createdAt  DateTime @default(now())
  updatedAt  DateTime @default(now()) @updatedAt
}

// model Account {
//   follower_id Int
//   followed_id Int

//   followed User @relation("followed", fields: [followed_id], references: [id])
//   follower User @relation("follower", fields: [follower_id], references: [id])

//   createdAt DateTime @default(now())
//   @@id([followed_id, follower_id])
// }

model Follow {
  id          Int     @id @default(autoincrement())
  follower_id String?
  followed_id String?

  follower User? @relation("follows", fields: [follower_id], references: [igId])
  followed User? @relation("followings", fields: [followed_id], references: [igId])

  createdAt DateTime @default(now())
  @@unique([followed_id, follower_id])
}
